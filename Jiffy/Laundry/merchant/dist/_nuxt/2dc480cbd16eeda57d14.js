(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{463:function(t,e,n){"use strict";n.r(e);var r=n(2),o=(n(27),n(3),n(399),n(29),{mounted:function(){var t=this.$fireAuthObj(),e=n(400);(e.auth.AuthUI.getInstance()||new e.auth.AuthUI(t)).start("#firebaseui-auth-container",{signInOptions:[{provider:this.$fireAuthObj.EmailAuthProvider.PROVIDER_ID,requireDisplayName:!0}],callbacks:{signInFailure:function(t){if(console.log(t),"firebaseui/anonymous-upgrade-merge-conflict"!=t.code)return Promise.resolve();t.credential;return!1},signInSuccessWithAuthResult:function(t,e){return!1}}})},methods:{}}),c=n(24),l=Object(c.a)(o,(function(){var t=this.$createElement;return(this._self._c||t)("div",{attrs:{id:"firebaseui-auth-container"}})}),[],!1,null,null,null).exports,d=Object(r.a)({layout:"menu",middleware:function(t){var e=t.store,n=t.redirect;if(e.getters["auth/isAuth"]&&e.getters["auth/getUser"].admin)return n("/")},data:function(){return{cities:[],valid:!0,activeBtn:0,loading:!1,pass1:"",pass2:"",preSignUp:{business_name:"",contact:{position:"Owner",person:"",email:"",phone:""},city:"Puerto Princesa City"},loginDialog:!1,login:!0,snackbar:!1,text:"",color:"",timeout:3500,nameRules:[function(t){return!!t||"This  is required"}],emailRules:[function(t){return!!t||"E-mail is required"},function(t){return/.+@.+\..+/.test(t)||"E-mail must be valid"}],passwordRules:[function(t){return!!t||"Password is required"}],phonRules:[function(t){return!!t||"Phone number is required"},function(t){return t&&10==t.length||"Name must be 10 characters"}]}},components:{FireUi:l},watch:{isAuth:function(){this.isAuth&&this.attemptLogin()},activeBtn:function(t){1===t&&this.getCities()}},mounted:function(){this.attemptLogin()},computed:{isMatchPWD:function(){return this.pass1!=this.pass2||"Password mismatch"},isAuth:function(){return this.$store.getters["auth/isAuth"]},isAdmin:function(){return this.$store.getters["auth/isAuth"]}},methods:{Login:function(){var t=this;this.$fireAuth.signInWithEmailAndPassword(this.preSignUp.contact.email,this.pass1).catch((function(e){t.snackbar=!0,t.color="error",t.text="Account Not Exist"}))},attemptLogin:function(){var t=this;this.$fireAuth.currentUser.getIdTokenResult().then((function(e){t.$store.commit("auth/setIsMerchant",e.claims.merchant),e.claims.merchant?(t.snackbar=!0,t.color="success",t.text="Login Successful",t.$fireStoreObj().collection("food_merchants").where("users","array-contains",t.$fireAuth.currentUser.uid).get().then((function(e){var n=[];e.docs.forEach((function(t){n.push({id:t.id,data:t.data()})})),t.$store.commit("auth/setBusinesses",n),t.$store.commit("auth/setDefaultBusiness",n[0]),setTimeout((function(){t.$router.push("/")}),1e3)}))):(t.snackbar=!0,t.color="error",t.text="Unauthorized Access",setTimeout((function(){t.$fireAuth.signOut()}),1e3))})).catch((function(t){console.log(t)}))},getCities:function(){var t=this;this.$fireStoreObj().collection("areas").get().then((function(e){e.docs.forEach((function(area){t.cities.push({id:area.id,data:area.data().d})})),t.cities.sort((function(a,b){return a.data.name>b.data.name?1:b.data.name>a.data.name?-1:0}))}))},preRegister:function(){var t=this;this.$refs.form.validate()?(this.loading=!0,this.preSignUp.pass1=this.pass1,this.$fireFunc.httpsCallable("createMerchantAccount")(this.preSignUp).then((function(e){t.loading=!1,e.data.success?(t.color="success",t.text="Merchant Account Registered",t.$fireAuth.signInWithEmailAndPassword(t.preSignUp.contact.email,t.pass1),t.$refs.form.reset()):(t.text=e.data.message.errorInfo.message,t.color="error"),t.snackbar=!0})).catch((function(t){console.log(t)}))):alert("Invalid Form")}}},"mounted",(function(){localStorage.removeItem("vuex"),this.$store.commit("auth/setLastUpdate",0),this.$store.commit("auth/setIsMerchant",!0)})),v=n(49),f=n.n(v),m=n(362),h=n(158),x=n(446),_=n(171),S=n(153),k=n(57),w=n(410),U=n(365),A=n(351),$=n(360),P=n(454),y=n(152),C=n(129),V=n(361),I=n(396),R=n(455),O=n(368),B=n(392),E=n(445),L=n(167),F=Object(c.a)(d,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-layout",[n("loading",{attrs:{active:t.loading,loader:"bars","is-full-page":!0,color:"blue"},on:{"update:active":function(e){t.loading=e}}}),t._v(" "),n("v-app-bar",{staticClass:"white--text text-center",attrs:{color:"blue",dense:"",app:"",fixed:""}},[n("v-toolbar-title",[t._v("Jiffy Favors Partners")])],1),t._v(" "),n("v-content",[n("v-container",[n("v-layout",{attrs:{wrap:"","justify-center":"","align-center":"","text-left":""}},[1==t.activeBtn?n("v-flex",{attrs:{xs12:"",md6:"",sm6:"",lg6:""}},[n("v-card",[n("v-card-title",{staticClass:"headline green--text"},[t._v("Food Merchant Partner Signup")]),t._v(" "),n("v-card-text",[n("v-form",{ref:"form",attrs:{"lazy-validation":""},model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[n("v-layout",{attrs:{wrap:""}},[n("v-flex",{attrs:{xs12:""}},[n("v-text-field",{attrs:{dense:"",rules:t.nameRules,required:"",placeholder:"Business Name",outlined:""},model:{value:t.preSignUp.business_name,callback:function(e){t.$set(t.preSignUp,"business_name",e)},expression:"preSignUp.business_name"}})],1),t._v(" "),n("v-flex",{attrs:{xs8:""}},[n("v-text-field",{attrs:{dense:"",rules:t.nameRules,placeholder:"Contact Person",outlined:""},model:{value:t.preSignUp.contact.person,callback:function(e){t.$set(t.preSignUp.contact,"person",e)},expression:"preSignUp.contact.person"}})],1),t._v(" "),n("v-flex",{attrs:{xs4:""}},[n("v-select",{attrs:{dense:"",outlined:"",items:["Owner","Operation's Manager","Marketing","Operator"],rules:[function(t){return!!t||"Position is required"}],placeholder:"Position"},model:{value:t.preSignUp.contact.position,callback:function(e){t.$set(t.preSignUp.contact,"position",e)},expression:"preSignUp.contact.position"}})],1),t._v(" "),n("v-flex",{attrs:{xs6:""}},[n("v-text-field",{attrs:{dense:"",prefix:"+63",rules:t.phonRules,placeholder:"Mobile Phone",outlined:""},model:{value:t.preSignUp.contact.phone,callback:function(e){t.$set(t.preSignUp.contact,"phone",e)},expression:"preSignUp.contact.phone"}})],1),t._v(" "),n("v-flex",{attrs:{xs6:""}},[n("v-select",{attrs:{dense:"",items:t.cities,rules:[function(t){return!!t||"City is required"}],label:"City of Operation",outlined:"","item-text":"data.name","item-value":"id"},model:{value:t.preSignUp.city,callback:function(e){t.$set(t.preSignUp,"city",e)},expression:"preSignUp.city"}})],1),t._v(" "),n("v-flex",{attrs:{xs12:""}},[n("v-subheader",{staticClass:"subtitle-2 green--text"},[t._v("Create Login Account")]),t._v(" "),n("v-divider")],1),t._v(" "),n("v-flex",{attrs:{xs12:""}},[n("v-text-field",{attrs:{dense:"",type:"email",rules:t.emailRules,placeholder:"Email Address",outlined:""},model:{value:t.preSignUp.contact.email,callback:function(e){t.$set(t.preSignUp.contact,"email",e)},expression:"preSignUp.contact.email"}})],1),t._v(" "),n("v-flex",{attrs:{xs6:""}},[n("v-text-field",{attrs:{dense:"",type:"password",placeholder:"Password",rules:[function(t){return!!t||"Password is required"},t.pass1===t.pass2||"Password must match"],outlined:""},model:{value:t.pass1,callback:function(e){t.pass1=e},expression:"pass1"}})],1),t._v(" "),n("v-flex",{attrs:{xs6:""}},[n("v-text-field",{attrs:{dense:"",type:"password",placeholder:"Confirm Password",rules:[function(t){return!!t||"Password is required"},t.pass1===t.pass2||"Password must match"],outlined:""},model:{value:t.pass2,callback:function(e){t.pass2=e},expression:"pass2"}})],1)],1)],1)],1),t._v(" "),n("v-card-actions",[n("v-spacer"),t._v(" "),n("v-btn",{attrs:{color:"info"},on:{click:function(e){return e.stopPropagation(),t.preRegister()}}},[t._v("Register")])],1)],1)],1):t._e(),t._v(" "),0==t.activeBtn?n("v-flex",{attrs:{xs12:"",md6:"",sm6:"",lg6:""}},[n("v-container",{staticClass:"text-xs-center mx-auto"},[n("v-card",{staticClass:"mx-auto",attrs:{flat:"","max-width":"100%"}},[n("v-layout",{attrs:{flat:"",wrap:"","justify-center":"","align-center":"","text-left":""}},[t.isAdmin||t.isAuth?t._e():n("v-flex",{staticClass:"text-center",attrs:{xs12:"",md8:"",sm8:"",lg8:""}},[n("v-avatar",{attrs:{size:"150",tile:""}},[n("v-img",{attrs:{src:"/icon.png"}})],1),t._v(" "),n("blockquote",{staticClass:"blockquote"},[n("h4",[t._v("Food Merchant System Access")])]),t._v(" "),n("v-card",[n("v-card-title",{staticClass:"headline green--text"},[t._v("Login")]),t._v(" "),n("v-card-text",[n("v-layout",{attrs:{wrap:""}},[n("v-flex",{attrs:{xs12:""}},[n("v-text-field",{attrs:{dense:"",type:"email",rules:t.emailRules,placeholder:"Email Address",outlined:""},model:{value:t.preSignUp.contact.email,callback:function(e){t.$set(t.preSignUp.contact,"email",e)},expression:"preSignUp.contact.email"}})],1),t._v(" "),n("v-flex",{attrs:{xs12:""}},[n("v-text-field",{attrs:{dense:"",type:"password",placeholder:"Password",outlined:""},model:{value:t.pass1,callback:function(e){t.pass1=e},expression:"pass1"}})],1)],1)],1),t._v(" "),n("v-card-actions",[n("v-spacer"),t._v(" "),n("v-btn",{attrs:{color:"info",block:""},on:{click:function(e){return e.stopPropagation(),t.Login()}}},[t._v("Login")])],1)],1)],1)],1)],1)],1)],1):t._e()],1),t._v(" "),n("v-bottom-navigation",{attrs:{fixed:"",value:t.activeBtn,grow:"",color:"teal"}},[n("v-btn",{on:{click:function(e){e.stopPropagation(),t.activeBtn=0}}},[n("span",[t._v("Login")]),t._v(" "),n("v-icon",[t._v("mdi-login")])],1),t._v(" "),n("v-btn",{on:{click:function(e){e.stopPropagation(),t.activeBtn=1}}},[n("span",[t._v("Register")]),t._v(" "),n("v-icon",[t._v("mdi-store")])],1)],1)],1)],1),t._v(" "),n("v-snackbar",{attrs:{color:t.color,timeout:t.timeout},model:{value:t.snackbar,callback:function(e){t.snackbar=e},expression:"snackbar"}},[t._v(" "+t._s(t.text)+" ")])],1)}),[],!1,null,null,null);e.default=F.exports;f()(F,{VAppBar:m.a,VAvatar:h.a,VBottomNavigation:x.a,VBtn:_.a,VCard:S.a,VCardActions:k.a,VCardText:k.b,VCardTitle:k.c,VContainer:w.a,VContent:U.a,VDivider:A.a,VFlex:$.a,VForm:P.a,VIcon:y.a,VImg:C.a,VLayout:V.a,VSelect:I.a,VSnackbar:R.a,VSpacer:O.a,VSubheader:B.a,VTextField:E.a,VToolbarTitle:L.a})}}]);